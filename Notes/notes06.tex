\input{PreambleCommon}
\input{../WeekTitles}

\begin{document}
\setfont
\pagestyle{fancy}
\renewcommand{\Week}{6 }
\renewcommand{\WeekTitle}{\WeekTitleSix }

\fancyhead[LE,RO]{Week \Week}  % default, usually only for first page
\fancyfoot{}
\sectionbox{Week \#\Week: \WeekTitle}


\vspace{5mm}
\goals
\begin{itemize}
\item Use MATLAB to solve a variety of integration problems. 
\item Use integration to find the average value of a function.
\item Use MATLAB to find the average value of a function. 
\item Use MATLAB to find the average value of a sequence of data. 
\end{itemize}
\vspace{5mm}


\topic{Numerical Integration - Motivation}
\subsection*{Numerical Integration - Motivation}
A common engineering challenge is to transfer heat generated by a
motor or combustion into a nearby fluid.

This transfer is often made more effective by the use of {\bf cooling
  fins}, which increase the surface area of contact with the fluid.

\begin{center}
  \includegraphics[width=5in]{graphics/notes_06_LongPin3D}
\end{center}

If we fix the temperature at the base, we can ask the question \\
{\bf ``How quickly is heat radiated out of fin?''}

\newpage
\vsc
\problem What factors affect the rate of heat transfer out of the
  fin?

\begin{center}
\includegraphics[width=3.5in]{graphics/notes_06_LongPin3D}
\end{center}

\vfill
\vfill

\newpage

\problem Take a small slice of length $\Delta x$ of the fin: how much
  heat is lost through that slice?
\begin{center}
\includegraphics[width=3.5in]{graphics/notes_06_LongPin3D}
\end{center}

\vfill

Give an expression for the total amount of heat lost over
  the whole fin.

\vfill
\vfill


\newpage


\subsection*{Integration}

As soon as you see any sum of the form $\sum \ldots \Delta x$, you
should be thinking ``Integral''!

For our fin example, net heat flow to environment is
%\begin{align*}
%\int_S h (T(x) - T_{\infty} )~dA 
%\end{align*}
\vfill
If, for simplicity, we assume $T_{\infty} = 0$, our target integral becomes
%\begin{align*}
%\mbox{Heat rate} = \int_S h ~T(x)~dA 
%\end{align*}
\vfill

\newpage

\subsection*{Finding the Temperature Distribution}
To evaluate the integral, we first need to find the temperature
distribution along the fin.  Without getting into all the gory
details, the temperature along the fin will be given by the formula

$$T(x) = \frac{T_b \left(\cosh(m(L-x)) + \frac{h}{mk}\right)\left(\sinh(m(L-x))\right)}{\cosh(mL) + \frac{h}{mk} \sinh(mL)}$$

\problem What are these new $\cosh(x)$ and $\sinh(x)$ functions?



\newpage
\subsection*{Graphically}
Once we have the temperature distribution, we can graph it along the
length of the fin to see if it makes sense.

\begin{center}
\begin{minipage}{4.0in}
\includegraphics[width=4.0in]{graphics/notes_06_LongPin3D}
\end{minipage}
\begin{minipage}{4.0in}
\begin{center}
\includegraphics[height=4.0in]{graphics/notes_06_FinTemperature1}
\end{center}
\end{minipage}
\end{center}


\newpage


\subsection*{Computing Total Heat Loss}
Now, we have addressed one challenge in our problem: we know the
steady-state temperature along the fin.  Next, we want to compute
the net rate of heat flow out, or the cooling ability of the fin.

The heat flow out of the fin is given by
$$
Q = \int_0^{L} h ~P ~T(x) ~dx   ~~~~~~~~~~ (T_\infty \mbox{ assumed = 0})
$$
Our first approach, if it is possible, should be direct
anti-differentiation (think $\int x^2 ~dx = \frac{1}{3}x^3$).

For this problem, given the earlier temperature we found, $T(x)$, we
{\bf can} evaluate the integral exactly:
$$ \large
Q =
\frac{1}{2}\frac{T_b~P~h~(m~k~exp(2~m~L)-m~k+h~exp(2~m~L)+h-2~h~exp(m~L))}{m(\cosh(m~L)~m~k+h~\sinh(m~L))~exp(-m~L)}
$$
 

%Evaluated with appropriate constants for the material, base temp, etc. we would obtain the final value  $$Q = 2.362699501 \mbox{ J/s}$$

\newpage

\subsection*{Comments on Anti-Derivatives}

Through this last step, we reached what would be the important
engineering goal: obtaining the {\bf numerical value} for the
integral.

When we compute integrals analytically, by using anti-derivatives, we
are doing the best possible thing. 
\begin{itemize}
\item Integrals give exact values.
\item Integrals can be re-used immediately with different constants.
\end{itemize}
Unfortunately, actually computing the numerical value of an integral
using antiderivatives isn't always an option:
\begin{itemize}
\item Some functions don't have antiderivatives.  
\vspace{1cm}
\item Sometimes we don't have a function, but only data.
\vspace{1cm}
\item Sometimes we forget how to find the anti-derivative!
\vspace{1cm}
\end{itemize}

\newpage

\topic{Numerical Quadrature}
\subsection*{Numerical Quadrature}

The word {\em quadrature} comes from the Greek challenge of trying to
{\em square the circle}, or finding the {\bf area} (in square units)
of the round circle.

When you hear {\bf quadrature} think {\bf numerical integration}.

The two common scenarios where we need {\em numerical} integration will be:
\begin{itemize}
\item {\bf Formula} for $f(x)$ known, want $\ds \int_a^b f(x) dx$
\item {\bf Data} for $f(x)$ collected at $f(x_i)$, want $\ds \int_a^b f(x)
  dx$
\end{itemize}
We will study the formula case initially, because it is easier to
experiment with.  We will continue to use our temperature example,
$$
\int_0^{L} h ~P ~T(x) ~dx = 2.36269950112023 \mbox{ J/s}
$$

\newpage

Graphically, $\displaystyle \int_0^L \underbrace{h~P~T(x)}_{f(x)}~dx$
is the area shown below:
\begin{center}
\includegraphics[height=5cm]{graphics/notes_06_f_graph_with_area}
\end{center}
Numerical integration is performed by  
\begin{itemize}
\item separating the desired interval into {\em panels}
\item on each {\em panel}, evaluating the integrand, $f(x)$ one or
  more times and those values are combined in some way to {\em estimate}
  the area of the panel
\end{itemize}

\newpage

\subsection*{Left-Hand Sum}
The simplest quadrature rule is one we have already seen: the LEFT($n$) sum.
\begin{itemize}
\item Divide the interval into $n$ panels, width $\Delta x = (b-a) / n$
\item Evaluate function at the left end point,
  $f(x_{i-1})$ on each panel. 
\item Compute the area of rectangles, $\ds \sum_{i=1}^N f(x_{i-1}) \cdot \Delta x$ or
\end{itemize}
\begin{center}
\includegraphics[height=7cm]{graphics/notes_06_f_left_hand_rule}
\end{center}

\newpage

\subsection*{Quadrature Principles}
We are approximating a complex shape with simpler shapes for which we
can compute the area. The {\bf more panels} we use, the {\bf more
  accurate} the area estimate will be:
\begin{center}
\includegraphics[height=6cm]{graphics/notes_06_f_lhr_5_intervals}
\includegraphics[height=6cm]{graphics/notes_06_f_lhr_50_intervals}
\includegraphics[height=6cm]{graphics/notes_06_f_lhr_500_intervals}
\end{center}
By using enough panels, we can reduce the error to any level we like,
but then it takes longer to compute.

Our real question should be: as we do {\bf more work}, how much {\bf
  more accurate} does our answer become?

\newpage

\problem Download the file \texttt{W7\_1.m}, and extend it so it
  plots the graph of the temperature along the fin.

\vsc

\problem Estimate the integral $\ds Q = \int_0^L h P ~T(x) ~dx$ with
  the left-hand rule,
$$ Q \approx \sum_{i=1}^n h P ~T(x_i)~ \Delta x$$

\vsc

\problem Repeat the calculation, but using the \texttt{sum} command
instead of a loop.  Loops tend to be slow in MATLAB, compared to 
built-in matrix operations.

\vsc

\newpage

\problem Add a print statement that shows the number of intervals
  used, and the resulting error.  Experiment by doubling the number of
  intervals and seeing the resultant reduction in error.

\vsc

\problem Doubling the number of panels does what to the error?

\vfill

\newpage

% \problem Generate a plot of the number of intervals vs. the error.}

% \vsc

% \problem How can you modify the graph of number of panels vs.
%   error to show that the error is in fact being halved every time you
%   double the number of intervals?}

% \vfill
% \vfill

We now have a procedure for estimating integrals {\bf without} needing
to actually use any calculus.  Our next quest will be to make these
integral estimates as {\em accurate} as possible for the {\em least
  amount of work}.  In other words, we will be looking for more {\bf
  efficient} methods.

\newpage

\topic*{Built-In Integration in MATLAB }
\subsection*{Built-In Integration in MATLAB }

\Exercise{Look up the function \texttt{quad} or \texttt{integral} in MATLAB help.}

\vsc

\Exercise{Use \texttt{quad} on our sawtooth function and print the error.}

\vsc

\Exercise{Experiment with the options for \texttt{quad} to reduce the
  error further.}

\vsc

\ExampleCont{Comment on the error you ask for and the error you get.}

\vfill


\newpage

\subsection*{Costs of Adaptive Integration}

\ExampleCont{What programming approach would be best suited to
  calculating adaptive integral estimates?}

\vfill

\ExampleCont{How much more difficult would programming an adaptive
  method be, compared to the fixed-interval Newton-Cotes methods like
  LHR and Simpson's rule?}

\vfill

\ExampleCont{What are some other run-time costs of using adaptive
  methods, compared to fixed-interval methods?}

\vfill

\newpage

\topic{Numerical Integration in MATLAB - Examples}
\subsection*{Numerical Integration in MATLAB - Examples}



\newpage


\end{document}

