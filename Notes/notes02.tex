\input{PreambleCommon}
\input{../WeekTitles}

\begin{document}
\setfont
\pagestyle{fancy}
\renewcommand{\Week}{2 }
\renewcommand{\WeekTitle}{\WeekTitleTwo }

\fancyhead[LE,RO]{Week \Week}  % default, usually only for first page
\fancyfoot{}
\sectionbox{Week \#\Week: \WeekTitle}


\vspace{5mm}
\goals
\begin{itemize}
\item Describe the meaning and value of linearization
\item Apply the technique of linearization to solve a variety of
  nonlinear equations
\item Use MATLAB to graph and compare functions with their
  linearizations
\item Use MATLAB to implement Newton's method
\item Calculate and interpret the first and second derivatives, as
  well as higher order derivatives
 \end{itemize}

\vspace{5mm}

\newpage
\topic{Linear Approximations}
\subsection*{Linear Approximations}

You should now feel comfortable in finding the derivative of a wide
variety of functions with formulas. \\[1ex]

In this section, we will explore how the derivatives you can compute
can be tied back to understanding the behaviour of the original
function. \\[1ex]

We will start by returning to the definition of the derivative, based
on the $\ds \frac{\mbox{rise}}{\mbox{run}}$ formula for slopes: 
\begin{align*} 
  f'(x) = \frac{d}{dx} f = \dfdx = \lim_{\Delta x \to 0} \frac{\Delta f}{\Delta x} = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}
\end{align*} 



\newpage 
For example, if $y = f(x)$, then 
\[ \lim_{\Delta x \to 0} \frac{\Delta y}{\Delta x} = f'(x) 
\]
\begin{problem}
 What is the relationship between $f'$ and $\Delta y$,
	$\Delta x$ for merely {\em small} delta values? 
\end{problem}
\vfill

         Now sketch a graph, and label the two points
        in the $\Delta x$ difference `$x$' and `$a$'.  What expression
        do we obtain for $f(x)$?

        \vfill

\newpage
%We want to have a name for the RHS of this approximation:
\begin{boxnote}
\[ L(x)=f(a) + f'(a) (x-a) 
\]
\end{boxnote}
\begin{problem}
 What are some names for this linear function?
\end{problem}


 \newpage
 \problem Consider the tangent line approximation to the graph of
 $f(x)=e^x$ at $(0,1)$.  Find the formula for the tangent line at that
 point.

\vfill
\begin{minipage}[t]{0.4\linewidth}
\vspace{0pt}
  Sketch the graph of $y = e^x$ and the linearization/tangent line.
\end{minipage}
\hfill
\begin{minipage}[t]{0.45\linewidth}
\vspace{0pt}
\includegraphics[width=0.9\linewidth]{graphics/empty_graph_square_12}
\end{minipage}

% A good approximation for $e^{0.5}$ is therefore: \\[2ex]
% \begin{enumerate}[A.]
% \item $e^{0.5 }\approx 0.5$ \\[2ex]
% \item $e^{0.5 }\approx 1+e^{.5}$ \\[2ex]
% \item $e^{0.5 }\approx 1+.5$ \\[2ex]
% \end{enumerate}

% \end{problem}


\newpage

%\conques{%
% A function $f$ and its derivative have the following values at 0 and
% 10:%
% \begin{center}
% \begin{tabular}{cc}
% $f(0) = 2$ & $f(10) = 5$ \\
% $f^\prime (0) = -1$ & $f^\prime (10) = 1$
% \end{tabular}
% \end{center}
% Which of the following calculations produces the best estimate for
% $f(0.2)$?
% \begin{enumerate}
% \item[A. ] $(0.02)\times (5-2) + 2 = 2.06$
% \item[B. ] 2
% \item[C. ] $(0.2)\times (-1) = -0.2$
% \item[D. ] $(-1)\times (0.2) + 2 = 1.8$
% \end{enumerate}
% }%

\topic{Tangent Lines to Graphs}

\begin{problem}
Sketch the function $\ds f(x)=\frac{1}{x}$.
\end{problem}

\includegraphics[width=4in]{graphics/empty_graph_square_12}

\newpage

\begin{problem}
If we drew a tangent line to $f(x)$ at $x=4$, what range we would expect for the slope there?

\begin{enumerate}[A.]
\item Slope above 1. \\[2ex]
\item Slope between 0 and 1.  \\[2ex]
\item Slope between 0 and -1.\\[2ex] 
\item Slope below -1.
\end{enumerate}
\end{problem}



\newpage
\begin{problem}
 Find the linearization of $\ds f(x)=\frac{1}{x}$ at $a=4$.
\end{problem}
\vfill
\vfill

Find the equation of the tangent line to the function
$\ds y=\frac{1}{x} $ at $x=4$.  \vfill

\newpage

\problem Sketch the graph of $\ds y=\frac{1}{x}$, and its tangent line at $x=4$. 

\includegraphics[width=4in]{graphics/empty_graph_square_12}


\newpage
\topic{Linear Approximations for Error Estimation} Linear
approximations can be useful for quick and simple error calculations.

\begin{problem}
  A rock formation with high density ores was identified using gravity
  measurements; the formation is roughly cubic in shape. The edge each
  side of the cube was found to be 370 m, with a possible error in
  measurement of 10 m.  

  Use the ideas of linear approximations to estimate the maximum
  possible error (positive or negative) in computing the {\bf volume}
  of the formation.
\end{problem}
	\vfill
	\vfill

\newpage
\problem What are the trade-offs of using the linear approximation to
obtain the above error estimate, compared to a direct calculation of
the possible volumes with the error measurements?  \vfill


% \noindent \ques{Find the linearization of $f(x)=1/x$ at $a=4$.}
% %%%%% begin solution %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \includesoln{\solntest}{\mbox{}\\[11cm]}{
% We can use our ``recipe'' to find the linearization of $f$:
% $$L(x)=f(a)+f'(a)(x-a)$$
% When $x=a$,
% \begin{align*}
% f(a) & = f(4)\\[0.1cm]
% & =\frac{1}{4}
% \end{align*}
% and
% \begin{align*}
% f'(a) & =-\frac{1}{a^2}\\[0.1cm]
% & = -\frac{1}{4^2}\\[0.1cm]
% & = -\frac{1}{16}
% \end{align*}
% So the linearization of $f(x)$ at $x=a$ is
% $$L(x)=\frac{1}{4}-\frac{1}{16}(x-4).\vi{1}$$}
% %%%%% end solution %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \ques{Find the equation of the tangent line to the hyperbola $y=1/x$
% at $x=4$.}
% %%%%% begin solution %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \includesoln{\solntest}{}{
% The tangent line of $y=\frac{1}{x}$ at $x=4$ and the line
% approximating the hyperbola $y=\frac{1}{x}$ at $x=4$ (linearization
% of the hyperbola) are the same line!  So using the previous example,
% we can write that the tangent line to the hyperbola at $x=4$ is
% $$y=\frac{1}{4}-\frac{1}{16}(x-4).$$}
%%%%% end solution %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\topic{The $\sin(x)$ Approximation}
\subsection*{The $\sin(x)$ Approximation}
One of the most commonly-used approximation in physics
is the relationship
\[ \sin(x) \approx x
\]
\begin{problem}
 Derive this relationship using linearization. \vfill
\end{problem}

 What is the fine-print that should {\bf always} be associated with this approximation? \vspace{1in}

\newpage

\problem Sketch the graphs of $y = \sin(x) $ and $y = x$. \\
Focus on the domain $\ds \frac{-\pi}{2} \le x \le  \frac{\pi}{2}$.

\includegraphics[width=4in]{graphics/empty_graph_square_12}


\newpage  Below are more detailed calculations relating
$\sin(x)$ and $x$.  

\vspace{0.2in}

{\LARGE
	\begin{tabular}{||r||c|c|c|c|c|c|c|c||} \hline
	$x$ (degrees) &  & & & & & & & \\ \hline
	$x$ (rad) & 0.0500&          0.1000&          0.1500  & 0.2000  &0.2500 & 0.3000 & 0.3500 & 0.4000\\ \hline
	$\sin(x)$ & 0.0500 &0.0998 &0.1494 &0.1987 &0.2474 &0.2955 &0.3429 &0.3894 \\ \hline
	\end{tabular}
}\\[1ex]

\problem Comment on the agreement between $y=x$ and $y=\sin(x)$ on the range shown.

\vfill \vfill \vfill Most people are more familiar with angles
measured in degrees than radians: fill in the row indicating how many
degrees are represented by the radian measures.  \vfill

\newpage

Just for fun, put your calculator into degree mode, and see whether
$\sin(x) \approx x$ still holds for small $x$.\\[1ex]

\begin{tabular}{c|c}
  $x$ (deg) & $\sin(x)$ \\ \hline
  2$^o$ &  \\[2ex]
  4$^o$ &  \\[2ex]
  6$^o$  &  \\[2ex]
\end{tabular}


\newpage
\topic{MATLAB Intro}
\subsection*{MATLAB Intro}


\newpage
\topic{Graphing in MATLAB}
\subsection*{Graphing in MATLAB}

Summary:

\begin{verbatim}
x = linspace(-2, 2);
y = exp(x);
plot(x, y)
\end{verbatim}


\newpage
\topic{Tangent Lines in MATLAB}
\subsection*{Tangent Lines in MATLAB}


\newpage
\topic{Solving Non-Linear Equations}
\subsection*{Solving Non-Linear Equations}

One surprisingly challenging area of mathematics is in pre-calculus:
simply solving equations with non-linear elements.

\problem Compare the difficulty in solving these two single-variable
equations.

Linear: $5 x = 10$ \vfill

Non-linear: $\ds e^x = x+5$ \vfill

\newpage

Some special types of non-linear equations {\bf can} be solved
algebraically.

\problem Find, by hand or with the help of a calculator, the solutions
to the following equations.

\[ x^2 + 2x + 3 = 0 \]
\vfill
\[ \log_{10}(x) = 3 \]
\vfill
\[ \sin(3x) = \cos(3x) \]
\vfill 
\newpage

Unfortunately, solving using algebra requires you understanding how to
manipulate particular functions.  Worse yet, equations can be simply
too complex to solve algebraically.

\problem Try to solve the following equations by hand: 
\[ \sin(3x) = x \]
\vfill
\[ xe^{-x} = 5 \]
\vfill

\newpage
\[ \sin(3x) = x \] 
\[ xe^{-x} = 5 \] 

In these more difficult cases, if we want a solution we must resort to
{\bf numerical methods}, which are all {\bf fancy versions of guess
  and check}!  This means numerical solutions are a poor second
choice, compared to by-hand solving:
\begin{itemize}
\item Numerical solutions give no insight into the solution
  (existence, patterns).
\item Numerical solving usually requires some amount of trial and
  error by the user.
\end{itemize}

\newpage

\subsection*{Example - Trajectories}
To generate a motivation for solving non-linear equations, we are
going to simulate the launch a motorcycle off the end of a ramp.  The
launch parameters are $v_0$, $y_0$, and $\theta_0$.

If you start with some basic physics equations, and break the trajectory into components,
you can arrive at the following formula:
$$ y= y_0 + \tan(\theta_0) ~x - \frac{1}{2} \frac{g}{\cos^2(\theta_0) (v_0)^2} ~x^2 $$



\newpage
\begin{center}
\includegraphics[width=8.5in]{graphics/notes_02_MotorcycleJump_2014}


Alex Harvill, age 19, lands 425 foot ramp-to-dirt record in May 2012.
\end{center}

\newpage


\problem{Write a MATLAB script, \texttt{W2\_1.m} that plots the
  trajectory of the motorcycle.  Use
\begin{itemize}
\item $y_0$ = 3 m, 
\item $v_0 = 20$ m/s, and 
\item $\theta_0$ = 30 degrees.
\end{itemize}
and choose the $x$ interval so it shows the impact point.
}

\vfill

\problem{Add a horizontal line on the trajectory graph that shows the
  ground level, $y=0$.  Draw it in black.}

\vfill

\newpage


\subsection*{Launch Angle - Ballistics}

Now consider the ballistics targeting problem, with practical
consequences on battlefields around the world.
\begin{center}
  Given the launch velocity, height, and a target $x$, what launch
  angle should be used?
\end{center}

\newpage 

\problem{Set $y_0 = 3$, and $v = 20$.  Experiment with the launch
  angle $\theta$ in MATLAB to find an angle that lands the motorcycle
  at $x=30$.}

\vfill

Comment on the simplicity and accuracy of this approach.

\newpage

\subsection*{Root-Finding vs Equation Solving}

In the ballistics example, it turns out to be very laborious, and
fairly inaccurate, to find the launch angle that will launch a
projectile on to a target.

\problem Express the targeting problem as a solution to a non-linear
equation.

\vfill

We will return to that example, but first we will consider the more
general challenge of solving non-linear equations, to give us a wider
context.

\newpage

Consider the following equations.
\begin{eqnarray*}
\mbox{Example 1: }\sin(x)  &  =  & \frac{1}{10} \ln(x) \\
\end{eqnarray*}
\begin{eqnarray*}
\mbox{Example 2: } x^5 - x^{10}   &  =  & e^{-x} \\
\end{eqnarray*}
Solving these equations as written involves balancing {\bf two}
functions, but life would be easier if we only had to deal with {\bf
  one}.

Rewrite each equation so that only one function is
  required.

\vfill

\newpage

{\bf Any} non-linear equation in the form $g(x) = h(x)$ can be written
as $f(x) = 0$ simply by moving all terms to the left side; the
solutions to both forms will be the same.  \\[1ex]

The $f(x) = 0$ form is preferable because:
\begin{itemize}
\item it only involves a single user-given function, and \\
\item all {\em non-linear equation solving} problems become {\em
    root-finding} problems.
\end{itemize}

\newpage

\subsection*{Newton's Method}

{\bf Concept:} If we are looking for the {\bf root of a non-linear
  function},

We can use that information to speed up our search.
\begin{itemize}
\item Pretend that $f(x)$ is linear, through some starting point
  $x=a, y=f(a))$.
\item Find the tangent line at $x=a$
\item Find $c$, the root of the tangent line. This should be closer to
  the real root of $f(x)$ than our original guess.
\end{itemize}

\newpage

{\bf Graphical Example} 

We want to find the $x$ values where the graph below crosses $y=0$.

\begin{itemize}
\item Suppose we start at initial guess of $a = 3$.
\item Draw a line through the pair of points, and follow it to its
  root, $x=c$.
\item Replace $a$ with the new point $c$.
\item Repeat the last two steps until $a$ and $c$ are almost the same,
  or don't change between iterations.
\end{itemize}

\newpage

\begin{center}
  \includegraphics[width=7in]{graphics/notes_02_secant_example_graph}
\includegraphics[width=7in]{graphics/notes_02_secant_example_graph_zoom}
\end{center}

\newpage

\subsection*{Computational Algorithm}
The previous graph was the graph of $$f(x) = e^{x/2} -x -10 \mbox{, which
came from the equation } e^{x/2} = x + 10$$

\problem{Use an anonymous function to define this function in MATLAB.}

\vfill

\newpage

How do we calculate the root of the tangent line to $f(x)$, if the
line is based on the point $x=a$?

\vfill
\vfill
\vfill


\newpage


{\bf Comments} 

Newton's method is a sophisticated method for solving non-linear
equations. Some quick notes:
\begin{itemize}
\item The starting value of $x=a$ must be {\bf close to} the root (see
  practice problems).
  \begin{itemize}
  \item In practice, people will graph the function $f(x)$ to get a
    rough idea for where the roots might be. 
  \end{itemize}
\item Newton's method is vastly superior to using guess-and-check, or
  using loops, to find high-accuracy approximate solutions.
\end{itemize}

\newpage
\topic{Newton's Method - Practice}
\subsection*{Newton's Method - Practice}

\problem Use Newton's method to find an approximate solution to
$$x e^{-x} = 5$$

\newpage
\problem Use Newton's method to find an approximate solution to  $$sin(x) = \frac{1}{10}\ln(x)$$


\end{document}

